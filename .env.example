# PivotQuant runtime env template
# Copy to .env and fill values as needed.

# --- Model governance / promotion ---
# Candidate manifest written by training
RF_CANDIDATE_MANIFEST=manifest_latest.json
# Active manifest served by ml_server and used by reports
RF_ACTIVE_MANIFEST=manifest_active.json
# Optional hard override (absolute/relative path) for serving/reporting manifest
# RF_MANIFEST_PATH=data/models/manifest_active.json
# Governance gates
MODEL_GOV_REQUIRED_TARGETS=reject,break
MODEL_GOV_REQUIRED_HORIZONS=5,15,60
MODEL_GOV_MIN_TRAINED_END_DELTA_MS=0
MODEL_GOV_MAX_MFE_REGRESSION_BPS=1.5
MODEL_GOV_MAX_MAE_WORSENING_BPS=2.0
MODEL_GOV_ALLOW_FEATURE_VERSION_CHANGE=false
# Emergency override: force promotion even if gates fail
MODEL_GOV_FORCE_PROMOTE=false

# --- Daily report notifications ---
# Comma-separated channels: email,imessage,webhook
ML_REPORT_NOTIFY_CHANNELS=email

# If true, retrain cycle (every 6h) sends notifications too.
# Keep false if using scheduled daily LaunchAgent to avoid spam.
ML_REPORT_NOTIFY_ON_RETRAIN=false
ML_REPORT_EMAIL_STYLE=compact
ML_REPORT_ANOMALY_LIMIT=6

# --- Immediate health alerts (ML / collector downtime) ---
# Default behavior: notify only on state transitions (DOWN, RECOVERED)
ML_ALERT_NOTIFY_CHANNELS=email
# Optional override recipient list (falls back to ML_REPORT_EMAIL_TO)
# ML_ALERT_EMAIL_TO=you@example.com
# Optional override sender (falls back to ML_REPORT_EMAIL_FROM)
# ML_ALERT_EMAIL_FROM=you@example.com
# Health endpoints to watch
ML_ALERT_ML_HEALTH_URL=http://127.0.0.1:5003/health
ML_ALERT_COLLECTOR_HEALTH_URL=http://127.0.0.1:5004/health
# LaunchAgent check frequency (seconds)
ML_ALERT_CHECK_INTERVAL_SEC=60
# Health request timeout per endpoint (seconds)
ML_ALERT_TIMEOUT_SEC=4
# Re-alert while still down (minutes). 0 = disabled (transition-only alerts)
ML_ALERT_REPEAT_MIN=0
# Subject prefixes
ML_ALERT_SUBJECT_PREFIX=[ALERT]
ML_ALERT_RECOVERY_PREFIX=[RECOVERED]

# Optional scheduled-delivery time overrides (Mac local time)
# ML_REPORT_MORNING_HOUR=8
# ML_REPORT_MORNING_MINUTE=5
# ML_REPORT_CLOSE_HOUR=17
# ML_REPORT_CLOSE_MINUTE=10
# Optional report date override controls:
# ML_REPORT_REPORT_DATE=2026-02-17
# ML_REPORT_REPORT_DATE_MODE=auto
# Modes: auto | et_today | latest_completed

# Email (SMTP)
ML_REPORT_EMAIL_TO=you@example.com
ML_REPORT_EMAIL_FROM=you@example.com
ML_REPORT_SMTP_HOST=smtp.gmail.com
ML_REPORT_SMTP_PORT=587
ML_REPORT_SMTP_USER=you@example.com
ML_REPORT_SMTP_PASS=replace_with_app_password
ML_REPORT_SMTP_USE_TLS=true

# Include runtime log tails in email body.
ML_REPORT_INCLUDE_LOG_TAILS=true
ML_REPORT_LOG_TAIL_LINES=80
# Optional cost model for impact section (bps)
ML_COST_SPREAD_BPS=0.8
ML_COST_SLIPPAGE_BPS=0.4
ML_COST_COMMISSION_BPS=0.1
# Session-aware staleness thresholds (US regular session hours, ET)
# 13.0h ~= 2 sessions, 19.5h ~= 3 sessions
ML_STALENESS_WARN_SESSION_HOURS=13
ML_STALENESS_KILL_SESSION_HOURS=19.5
# Optional override list (comma-separated absolute paths):
# ML_REPORT_LOG_FILES=/Users/you/PIVOT_QUANT/logs/retrain.log,/Users/you/PIVOT_QUANT/logs/ml_server.log

# iMessage (optional, comma-separated recipients)
# ML_REPORT_IMESSAGE_TO=+15551234567

# Webhook (optional)
# ML_REPORT_WEBHOOK_URL=https://example.com/webhook
